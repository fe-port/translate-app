{"version":3,"sources":["configs/constants.ts","provider/data.tsx","layout/DefaultLayout.tsx","utils/zip.ts","components/FixedFooter.tsx","components/EditableTranslate.tsx","components/MainContent.tsx","App.tsx","index.tsx"],"names":["DEFAULT_LANG","defaultGlobalData","hideTranslatedPanel","hideTranslatedLocales","visibleLang","locales","GlobalDataContext","createContext","langs","setConfig","GlobalDataProvider","props","useState","globalData","setGlobalData","map","item","filename","Provider","value","filter","lang","key","children","useGlobalData","useContext","DefaultLayout","className","parseZip","file","a","JsZip","loadAsync","zip","ret","Object","keys","files","fileKey","localeFile","dir","name","endsWith","async","localeContent","split","pop","replace","match","push","content","console","error","message","FixedFooter","onExport","rootRef","useRef","onSelectZipFile","useCallback","ref","onChange","v","style","width","getPopupContainer","current","Option","checked","e","target","length","type","onClick","accept","beforeUpload","showUploadList","EditableTranslate","defaultValue","inputVisible","setInputVisible","setValue","handleChange","Panel","changedValues","Map","shouldPanelDefaultCollapsed","panel","every","MainContent","actionRef","log","defaultLocale","find","locale","defaultJson","JSON","parse","localeJsons","reduce","obj","panels","arr","hash","description","defaultMessage","defaultActiveKeys","exportZip","forEach","langFolder","folder","newJson","sort","b","stringify","generateAsync","then","eleLink","document","createElement","download","display","href","URL","createObjectURL","body","appendChild","click","removeChild","downloadZip","defaultActiveKey","header","set","handleInputChange","TranslatePage","mainContentRef","minHeight","paddingBottom","ReactDOM","render","App","getElementById"],"mappings":"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","file":"static/js/main.6447072a.chunk.js","sourcesContent":["export const DEFAULT_LANG = 'defaults'\n","import React, { createContext, useContext, useState } from 'react'\nimport { DEFAULT_LANG } from 'src/configs/constants'\nimport { LocaleFileContent } from '../types'\n\ninterface GlobalData {\n  // 隐藏已翻译面板\n  hideTranslatedPanel: boolean\n  // 隐藏已翻译的配置\n  hideTranslatedLocales: boolean\n  // 显示的翻译语言\n  visibleLang: string\n  // 语言列表\n  locales: LocaleFileContent[]\n}\n\ninterface GlobalDataWithAction extends GlobalData {\n  langs: string[]\n  setConfig: (\n    key: keyof GlobalData,\n    value: boolean | string | LocaleFileContent[]\n  ) => void\n}\n\nconst defaultGlobalData = {\n  hideTranslatedPanel: false,\n  hideTranslatedLocales: false,\n  visibleLang: '',\n  locales: []\n}\n\nconst GlobalDataContext = createContext<GlobalDataWithAction>({\n  ...defaultGlobalData,\n  langs: [],\n  // eslint-disable-next-line @typescript-eslint/no-empty-function\n  setConfig: () => {}\n})\n\nconst GlobalDataProvider: React.FC = props => {\n  const [globalData, setGlobalData] = useState(defaultGlobalData)\n  const langs = globalData.locales.map(item => item.filename)\n  return (\n    <GlobalDataContext.Provider\n      value={{\n        ...globalData,\n        langs: langs.filter(lang => lang !== DEFAULT_LANG),\n        setConfig: (key, value) => {\n          setGlobalData({\n            ...globalData,\n            [key]: value\n          })\n        }\n      }}\n    >\n      {props.children}\n    </GlobalDataContext.Provider>\n  )\n}\n\nexport default GlobalDataProvider\n\nexport function useGlobalData() {\n  return useContext(GlobalDataContext)\n}\n","import React from 'react'\nimport FilterConfigProvider from '../provider/data'\n\ninterface Props {}\n\nconst DefaultLayout: React.FC<Props> = ({ children }) => {\n  return (\n    <main>\n      <h1 className=\"py-4 text-center text-2xl\">在线翻译</h1>\n      <FilterConfigProvider>\n        <div className=\"app-container \">\n          {children}\n        </div>\n      </FilterConfigProvider>\n    </main>\n  )\n}\n\nexport default DefaultLayout\n","import { message } from 'antd'\nimport JsZip from 'jszip'\nimport { LocaleFileContent, LocaleTranslates } from '../types'\n\nexport async function parseZip(file: File): Promise<LocaleFileContent[]> {\n  try {\n    const zip = await JsZip.loadAsync(file)\n    const ret: LocaleFileContent[] = []\n    for (const fileKey of Object.keys(zip.files)) {\n      const localeFile = zip.files[fileKey]\n      // 目录跳过，非json跳过\n      if (!localeFile.dir && localeFile.name.endsWith('.json')) {\n        const localeContent = await localeFile.async('string')\n        const filename = localeFile.name\n          .split('/')\n          .pop()\n          .replace(/\\.json/, '')\n        // 非法文件跳过\n        if (filename.match(/^[a-zA-Z-]+$/)) {\n          ret.push({\n            filename: localeFile.name\n              .split('/')\n              .pop()\n              .replace(/\\.json/, ''),\n            content: localeContent\n          })\n        }\n      }\n    }\n    return ret\n  } catch (error) {\n    console.error(error)\n    message.error('zip文件读取失败')\n  }\n  return []\n}\n\nexport function downloadZip(\n  langs: string[],\n  localeJsons: {\n    [key: string]: LocaleTranslates\n  }\n) {\n  const zip = new JsZip()\n  const langFolder = zip.folder('lang')\n  langs.forEach(lang => {\n    // json重新排序\n    const newJson = Object.keys(localeJsons[lang])\n      .sort((a, b) => (a < b ? -1 : 1))\n      .reduce<LocaleTranslates>((obj, key) => {\n        obj[key] = localeJsons[lang][key]\n        return obj\n      }, {})\n    langFolder.file(`${lang}.json`, JSON.stringify(newJson, null, 2))\n  })\n  // 把打包内容异步转成blob二进制格式\n  zip.generateAsync({ type: 'blob' }).then(function (content) {\n    // 下载的文件名\n    const filename = 'translate.zip'\n    // 创建隐藏的可下载链接\n    const eleLink = document.createElement('a')\n    eleLink.download = filename\n    eleLink.style.display = 'none'\n    // 下载内容转变成blob地址\n    eleLink.href = URL.createObjectURL(content)\n    // 触发点击\n    document.body.appendChild(eleLink)\n    eleLink.click()\n    // 然后移除\n    document.body.removeChild(eleLink)\n  })\n}\n","import { Button, Checkbox, Select, Upload } from 'antd'\nimport React, { useCallback, useRef } from 'react'\nimport { useGlobalData } from '../provider/data'\nimport { parseZip } from '../utils/zip'\n\ninterface Props {\n  langs: string[]\n  onExport: () => void\n}\n\nconst FixedFooter: React.FC<Props> = ({ langs, onExport }) => {\n  const rootRef = useRef(null)\n  const {\n    hideTranslatedPanel,\n    hideTranslatedLocales,\n    visibleLang,\n    setConfig,\n    locales\n  } = useGlobalData()\n\n  const onSelectZipFile = useCallback(\n    async ({ file }) => {\n      const locales = await parseZip(file)\n      setConfig('locales', locales)\n    },\n    [setConfig]\n  )\n\n  return (\n    <div className=\"fixed bottom-0 left-0 right-0\" ref={rootRef}>\n      <div className=\"p-4 flex items-center app-container up-shadow\">\n        <div className=\"flex items-center mr-6\">\n          <label>显示翻译语言：</label>\n          <Select\n            value={visibleLang}\n            onChange={v => setConfig('visibleLang', v)}\n            style={{ width: '120px' }}\n            getPopupContainer={() => rootRef.current!}\n          >\n            <Select.Option value=\"\">全部</Select.Option>\n            {langs.map(lang => (\n              <Select.Option key={lang} value={lang}>\n                {lang}\n              </Select.Option>\n            ))}\n          </Select>\n        </div>\n        <Checkbox\n          checked={hideTranslatedPanel}\n          onChange={e => setConfig('hideTranslatedPanel', e.target.checked)}\n        >\n          隐藏已翻译面板\n        </Checkbox>\n        <Checkbox\n          checked={hideTranslatedLocales}\n          onChange={e => setConfig('hideTranslatedLocales', e.target.checked)}\n        >\n          隐藏已翻译语言\n        </Checkbox>\n        {locales.length ? (\n          <Button className=\"ml-auto\" type=\"primary\" onClick={onExport}>\n            导出\n          </Button>\n        ) : (\n          <Upload\n            className=\"ml-auto\"\n            accept=\".zip\"\n            beforeUpload={() => false}\n            showUploadList={false}\n            onChange={onSelectZipFile}\n          >\n            <Button type=\"primary\">选择zip文件上传</Button>\n          </Upload>\n        )}\n      </div>\n    </div>\n  )\n}\n\nexport default FixedFooter\n","import React, { useCallback, useState } from 'react'\n\ninterface Props {\n  defaultValue: string\n  onChange?: (v: string) => void\n}\n\nconst EditableTranslate: React.FC<Props> = ({ defaultValue, onChange }) => {\n  const [inputVisible, setInputVisible] = useState(!defaultValue)\n  const [value, setValue] = useState(defaultValue ?? '')\n  const handleChange = useCallback(\n    e => {\n      setValue(e.target.value)\n      onChange?.(e.target.value)\n    },\n    [onChange]\n  )\n  return !inputVisible ? (\n    <span onClick={() => setInputVisible(true)}>{defaultValue}</span>\n  ) : (\n    <input className=\"w-full border-b focus:border-blue-500 appearance-none focus:outline-none\"\n      value={value}\n      onChange={handleChange}\n    />\n  )\n}\n\nexport default EditableTranslate\n","import React from 'react'\nimport { Collapse } from 'antd'\nimport EditableTranslate from './EditableTranslate'\nimport { useGlobalData } from '../provider/data'\nimport { LocaleTranslateItem } from '../types'\nimport { DEFAULT_LANG } from '../configs/constants'\nimport { downloadZip } from 'src/utils/zip'\n\nconst { Panel } = Collapse\ninterface LocaleTranslates {\n  [key: string]: LocaleTranslateItem\n}\ninterface LangPanelProps {\n  description: string\n  hash: string\n  langs: string[]\n  locales: { [key: string]: string }\n}\n\nexport interface MainContentAction {\n  exportZip: () => void\n}\n\nconst changedValues: Map<\n  {\n    lang: string\n    hash: string\n  },\n  string\n> = new Map()\n\nfunction shouldPanelDefaultCollapsed(\n  panel: LangPanelProps,\n  visibleLang?: string\n) {\n  return panel.langs.every(\n    lang => (visibleLang && lang !== visibleLang) || panel.locales[lang]\n  )\n}\n\nconst MainContent: React.FC<{\n  actionRef: React.MutableRefObject<MainContentAction>\n}> = ({ actionRef }) => {\n  const {\n    hideTranslatedPanel,\n    hideTranslatedLocales,\n    visibleLang,\n    locales,\n    langs\n  } = useGlobalData()\n\n  console.log('locales', locales)\n\n  // 没有配置\n  if (!locales.length) {\n    return (\n      <p className=\"text-blue-600 empty-content\">\n        暂无国际化配置，请使用导入按钮导入zip文件\n      </p>\n    )\n  }\n  // 读取默认翻译\n  const defaultLocale = locales.find(locale => locale.filename === DEFAULT_LANG)\n\n  // 解析默认翻译中的所有hash数据\n  let defaultJson: LocaleTranslates = {}\n  try {\n    defaultJson = JSON.parse(defaultLocale.content) as LocaleTranslates\n  } catch (error) {\n    console.error(error)\n    return (\n      <p className=\"text-red-600 empty-content\">\n        解析源文件失败，请检查上传的zip文件是否正确!\n      </p>\n    )\n  }\n\n  try {\n    // locales数组转json map\n    const localeJsons = locales.reduce<{\n      [key: string]: LocaleTranslates\n    }>((obj, locale) => {\n      // 默认翻译不展示\n      if (locale.filename !== DEFAULT_LANG) {\n        obj[locale.filename] = JSON.parse(locale.content) as LocaleTranslates\n      }\n      return obj\n    }, {})\n\n    // 面板数据\n    const panels = Object.keys(defaultJson).reduce<LangPanelProps[]>(\n      (arr, hash) => {\n        const panel = {\n          description: defaultJson[hash].description,\n          hash,\n          langs,\n          locales: langs.reduce<{ [key: string]: string }>((obj, lang) => {\n            obj[lang] = localeJsons[lang][hash]?.defaultMessage\n            return obj\n          }, {})\n        }\n        if (\n          !(\n            hideTranslatedPanel &&\n            shouldPanelDefaultCollapsed(panel, visibleLang)\n          )\n        ) {\n          arr.push(panel)\n        }\n        return arr\n      },\n      []\n    )\n\n    // 如果所有语言都有翻译，则默认收起\n    const defaultActiveKeys = panels.reduce<string[]>((arr, panel) => {\n      if (!shouldPanelDefaultCollapsed(panel)) {\n        arr.push(panel.hash)\n      }\n      return arr\n    }, [])\n\n    // 输入框内容变化\n    const handleInputChange = (v: string, lang: string, hash: string) => {\n      changedValues.set(\n        {\n          lang,\n          hash\n        },\n        v\n      )\n    }\n\n    // 赋值导出函数\n    if (actionRef) {\n      actionRef.current = {\n        exportZip: () => {\n          // 更新localeJsons\n          changedValues.forEach((value, key) => {\n            // 可能不存在该key\n            if (!localeJsons[key.lang][key.hash]) {\n              localeJsons[key.lang][key.hash] = {\n                defaultMessage: '',\n                description: defaultJson[key.hash].description\n              }\n            }\n            localeJsons[key.lang][key.hash].defaultMessage = value\n          })\n          downloadZip(langs, localeJsons)\n        }\n      }\n    }\n\n    return (\n      <Collapse defaultActiveKey={defaultActiveKeys}>\n        {panels.map(panel => (\n          <Panel\n            header={\n              panel.description ? (\n                `描述：${panel.description}`\n              ) : (\n                <span className=\"text-red-600 empty-content\">未提供描述</span>\n              )\n            }\n            key={panel.hash}\n          >\n            <div>\n              {panel.langs.map(lang => {\n                if (\n                  !(hideTranslatedLocales && panel.locales[lang]) &&\n                  !(visibleLang && lang !== visibleLang)\n                ) {\n                  return (\n                    <p className=\"translate-item\" key={lang}>\n                      <span className=\"translate-item-label\">{lang}:</span>\n                      <span className=\"translate-item-value\">\n                        <EditableTranslate\n                          defaultValue={panel.locales[lang]}\n                          onChange={v => handleInputChange(v, lang, panel.hash)}\n                        />\n                      </span>\n                    </p>\n                  )\n                }\n                return null\n              })}\n            </div>\n          </Panel>\n        ))}\n      </Collapse>\n    )\n  } catch (e) {\n    console.error(e)\n    return (\n      <p className=\"text-red-600 empty-content\">\n        解析文件失败，请检查上传的zip文件是否正确!\n      </p>\n    )\n  }\n}\n\nexport default MainContent\n","import React, { useRef } from 'react'\nimport FixedFooter from './components/FixedFooter'\nimport MainContent, { MainContentAction } from './components/MainContent'\nimport { useGlobalData } from './provider/data'\n\nconst TranslatePage: React.FC = () => {\n  const mainContentRef = useRef<MainContentAction>()\n  const { langs } = useGlobalData()\n  // 导出\n  const doExport = () => {\n    mainContentRef.current.exportZip()\n  }\n\n  return (\n    <div style={{ minHeight: 'calc(100vh - 64px)', paddingBottom: '84px' }}>\n      <MainContent actionRef={mainContentRef} />\n      <FixedFooter langs={langs} onExport={doExport} />\n    </div>\n  )\n}\n\nexport default TranslatePage\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport DefaultLayout from './layout/DefaultLayout'\nimport App from './App'\n\nimport 'tailwindcss/tailwind.css'\nimport './styles/index.css'\n\nReactDOM.render(<DefaultLayout><App /></DefaultLayout>, document.getElementById('root'))\n"],"sourceRoot":""}